import { EventEmitter } from '@angular/core';
export class TableBase {
    // Header
    tableHeaders;
    // Data
    tableData;
    // Backup
    backupData; // For backup the table data, so that additional processes won't be affecting it
    // Pagination
    paginationEnabled = false;
    allowedPageSizes = [10, 25, 50, 100];
    pageSize = 10;
    totalPages = 0;
    currentPage = 1;
    paginationButtons = [];
    // Table Action Events
    cellContentClicked = new EventEmitter();
    cellContentHover = new EventEmitter();
    // Table Size
    height = 400;
    // Overlays
    loading = false;
    noData = false;
    loadingMessage;
    noDataMessage;
    constructor() { }
    setBackupData(data) {
        this.backupData = JSON.parse(JSON.stringify(data ?? []));
    }
    sort(field, order) {
        if (!order) {
            this.tableData = JSON.parse(JSON.stringify(this.backupData ?? []));
        }
        else {
            this.tableData = this.tableData.sort((a, b) => {
                if (a[field] < b[field]) {
                    return order === 'asc' ? -1 : 1;
                }
                if (a[field] > b[field]) {
                    return order === 'asc' ? 1 : -1;
                }
                return 0;
            });
        }
    }
    filter(filterValue, headers) {
        // this.backupData = (filterValue && !this.backupData?.length) ? this.setBackupData(this.tableData) : this.backupData; // Taking the backup of original data
        if (headers?.length) {
            this.filterBySpecifiedFields(headers, filterValue);
        }
        else {
            this.filterByAllFields(filterValue);
        }
    }
    filterByAllFields(filterValue) {
        const nonSearchableHeaders = this.tableHeaders?.filter(header => header?.search?.columnSearchIgnored); // Filtering the search not allowed column headers
        const nonSearchFields = nonSearchableHeaders?.map(header => header.field);
        let temporaryData = JSON.parse(JSON.stringify(this.backupData ?? []));
        temporaryData = temporaryData.filter((record) => {
            for (const recordField in (record ?? {})) {
                if (!nonSearchFields?.includes(recordField)) {
                    const value = record[recordField];
                    if (typeof value === 'string' && value?.length && value.toLowerCase().includes(filterValue.toLowerCase())) {
                        return true;
                    }
                }
            }
            return false;
        });
        this.tableData = temporaryData;
    }
    filterBySpecifiedFields(filterValue, headers) {
    }
    loadPagination() {
        if (this.paginationEnabled && this.backupData?.length) {
            this.totalPages = Math.ceil(this.pageSize && this.backupData.length ? this.backupData.length / this.pageSize : 0);
            this.changePagination(1);
        }
    }
    changePagination(page) {
        this.currentPage = page;
        this.tableData = this.getCurrentPageData();
    }
    getCurrentPageData() {
        if (this.currentPage && this.pageSize && this.backupData?.length) {
            const pageStartIndex = (this.currentPage * this.pageSize) - this.pageSize;
            return this.backupData.slice(pageStartIndex, pageStartIndex + this.pageSize);
        }
        return [];
    }
    setLoading(loading) {
        this.loading = loading;
    }
    setNoData(noData) {
        this.noData = noData;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFibGUtYmFzZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tbW9ucy90YWJsZS90YWJsZS1iYXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFFM0MsTUFBTSxPQUFPLFNBQVM7SUFDbEIsU0FBUztJQUNGLFlBQVksQ0FBNEI7SUFFL0MsT0FBTztJQUNBLFNBQVMsQ0FBTTtJQUV0QixTQUFTO0lBQ0YsVUFBVSxDQUFNLENBQUMsZ0ZBQWdGO0lBRXhHLGFBQWE7SUFDYixpQkFBaUIsR0FBWSxLQUFLLENBQUM7SUFDbkMsZ0JBQWdCLEdBQWEsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUMvQyxRQUFRLEdBQVcsRUFBRSxDQUFDO0lBQ3RCLFVBQVUsR0FBRyxDQUFDLENBQUM7SUFDZixXQUFXLEdBQUcsQ0FBQyxDQUFDO0lBQ2hCLGlCQUFpQixHQUFVLEVBQUUsQ0FBQztJQUU5QixzQkFBc0I7SUFDZixrQkFBa0IsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBQ3hDLGdCQUFnQixHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7SUFFN0MsYUFBYTtJQUNiLE1BQU0sR0FBVyxHQUFHLENBQUM7SUFFckIsV0FBVztJQUNYLE9BQU8sR0FBWSxLQUFLLENBQUM7SUFDekIsTUFBTSxHQUFZLEtBQUssQ0FBQztJQUN4QixjQUFjLENBQVU7SUFDeEIsYUFBYSxDQUFVO0lBRXZCLGdCQUFnQixDQUFDO0lBRWpCLGFBQWEsQ0FBQyxJQUFTO1FBQ25CLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFBO0lBQzVELENBQUM7SUFFRCxJQUFJLENBQUMsS0FBYSxFQUFFLEtBQXlC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R0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2xILElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3QixDQUFDO0lBQ0wsQ0FBQztJQUVELGdCQUFnQixDQUFDLElBQVM7UUFDdEIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7UUFDeEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztJQUMvQyxDQUFDO0lBRUQsa0JBQWtCO1FBQ2QsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRSxNQUFNLEVBQUUsQ0FBQztZQUMvRCxNQUFNLGNBQWMsR0FBRyxDQUFDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7WUFDMUUsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxjQUFjLEVBQUUsY0FBYyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNqRixDQUFDO1FBQ0QsT0FBTyxFQUFFLENBQUM7SUFDZCxDQUFDO0lBRUQsVUFBVSxDQUFDLE9BQWdCO1FBQ3ZCLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0lBQzNCLENBQUM7SUFFRCxTQUFTLENBQUMsTUFBZTtRQUNyQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN6QixDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1RhYmxlSGVhZGVyfSBmcm9tICcuLi9tb2RlbHMvdGFibGUtaGVhZGVyJztcbmltcG9ydCB7RXZlbnRFbWl0dGVyfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlQmFzZSB7XG4gICAgLy8gSGVhZGVyXG4gICAgcHVibGljIHRhYmxlSGVhZGVyczogVGFibGVIZWFkZXJbXSB8IHVuZGVmaW5lZDtcblxuICAgIC8vIERhdGFcbiAgICBwdWJsaWMgdGFibGVEYXRhOiBhbnk7XG5cbiAgICAvLyBCYWNrdXBcbiAgICBwdWJsaWMgYmFja3VwRGF0YTogYW55OyAvLyBGb3IgYmFja3VwIHRoZSB0YWJsZSBkYXRhLCBzbyB0aGF0IGFkZGl0aW9uYWwgcHJvY2Vzc2VzIHdvbid0IGJlIGFmZmVjdGluZyBpdFxuXG4gICAgLy8gUGFnaW5hdGlvblxuICAgIHBhZ2luYXRpb25FbmFibGVkOiBib29sZWFuID0gZmFsc2U7XG4gICAgYWxsb3dlZFBhZ2VTaXplczogbnVtYmVyW10gPSBbMTAsIDI1LCA1MCwgMTAwXTtcbiAgICBwYWdlU2l6ZTogbnVtYmVyID0gMTA7XG4gICAgdG90YWxQYWdlcyA9IDA7XG4gICAgY3VycmVudFBhZ2UgPSAxO1xuICAgIHBhZ2luYXRpb25CdXR0b25zOiBhbnlbXSA9IFtdO1xuXG4gICAgLy8gVGFibGUgQWN0aW9uIEV2ZW50c1xuICAgIHB1YmxpYyBjZWxsQ29udGVudENsaWNrZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgcHVibGljIGNlbGxDb250ZW50SG92ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICAvLyBUYWJsZSBTaXplXG4gICAgaGVpZ2h0OiBudW1iZXIgPSA0MDA7XG5cbiAgICAvLyBPdmVybGF5c1xuICAgIGxvYWRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBub0RhdGE6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBsb2FkaW5nTWVzc2FnZSE6IHN0cmluZztcbiAgICBub0RhdGFNZXNzYWdlITogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoKSB7IH1cblxuICAgIHNldEJhY2t1cERhdGEoZGF0YTogYW55KSB7XG4gICAgICAgIHRoaXMuYmFja3VwRGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSA/PyBbXSkpXG4gICAgfVxuXG4gICAgc29ydChmaWVsZDogc3RyaW5nLCBvcmRlcjogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghb3JkZXIpIHtcbiAgICAgICAgICAgIHRoaXMudGFibGVEYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmJhY2t1cERhdGEgPz8gW10pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGFibGVEYXRhID0gdGhpcy50YWJsZURhdGEuc29ydCgoYTogYW55LCBiOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoYVtmaWVsZF0gPCBiW2ZpZWxkXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXIgPT09ICdhc2MnID8gLTEgOiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYVtmaWVsZF0gPiBiW2ZpZWxkXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXIgPT09ICdhc2MnID8gMSA6IC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZmlsdGVyKGZpbHRlclZhbHVlOiBhbnksIGhlYWRlcnM/OiBUYWJsZUhlYWRlcltdKSB7XG4gICAgICAgIC8vIHRoaXMuYmFja3VwRGF0YSA9IChmaWx0ZXJWYWx1ZSAmJiAhdGhpcy5iYWNrdXBEYXRhPy5sZW5ndGgpID8gdGhpcy5zZXRCYWNrdXBEYXRhKHRoaXMudGFibGVEYXRhKSA6IHRoaXMuYmFja3VwRGF0YTsgLy8gVGFraW5nIHRoZSBiYWNrdXAgb2Ygb3JpZ2luYWwgZGF0YVxuICAgICAgICBpZiAoaGVhZGVycz8ubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlckJ5U3BlY2lmaWVkRmllbGRzKGhlYWRlcnMsIGZpbHRlclZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyQnlBbGxGaWVsZHMoZmlsdGVyVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZmlsdGVyQnlBbGxGaWVsZHMoZmlsdGVyVmFsdWU6IGFueSkge1xuICAgICAgICBjb25zdCBub25TZWFyY2hhYmxlSGVhZGVycyA9IHRoaXMudGFibGVIZWFkZXJzPy5maWx0ZXIoaGVhZGVyID0+IGhlYWRlcj8uc2VhcmNoPy5jb2x1bW5TZWFyY2hJZ25vcmVkKTsgLy8gRmlsdGVyaW5nIHRoZSBzZWFyY2ggbm90IGFsbG93ZWQgY29sdW1uIGhlYWRlcnNcbiAgICAgICAgY29uc3Qgbm9uU2VhcmNoRmllbGRzID0gbm9uU2VhcmNoYWJsZUhlYWRlcnM/Lm1hcChoZWFkZXIgPT4gaGVhZGVyLmZpZWxkKTtcbiAgICAgICAgbGV0IHRlbXBvcmFyeURhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuYmFja3VwRGF0YSA/PyBbXSkpO1xuICAgICAgICB0ZW1wb3JhcnlEYXRhID0gdGVtcG9yYXJ5RGF0YS5maWx0ZXIoXG4gICAgICAgICAgICAocmVjb3JkOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJlY29yZEZpZWxkIGluIChyZWNvcmQgPz8ge30pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbm9uU2VhcmNoRmllbGRzPy5pbmNsdWRlcyhyZWNvcmRGaWVsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcmVjb3JkW3JlY29yZEZpZWxkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlPy5sZW5ndGggJiYgdmFsdWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJWYWx1ZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy50YWJsZURhdGEgPSB0ZW1wb3JhcnlEYXRhO1xuICAgIH1cblxuICAgIGZpbHRlckJ5U3BlY2lmaWVkRmllbGRzKGZpbHRlclZhbHVlOiBhbnksIGhlYWRlcnM/OiBUYWJsZUhlYWRlcltdKSB7XG5cbiAgICB9XG5cbiAgICBsb2FkUGFnaW5hdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMucGFnaW5hdGlvbkVuYWJsZWQgJiYgdGhpcy5iYWNrdXBEYXRhPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMudG90YWxQYWdlcyA9IE1hdGguY2VpbCh0aGlzLnBhZ2VTaXplICYmIHRoaXMuYmFja3VwRGF0YS5sZW5ndGggPyB0aGlzLmJhY2t1cERhdGEubGVuZ3RoIC8gdGhpcy5wYWdlU2l6ZSA6IDApO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VQYWdpbmF0aW9uKDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2hhbmdlUGFnaW5hdGlvbihwYWdlOiBhbnkpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IHBhZ2U7XG4gICAgICAgIHRoaXMudGFibGVEYXRhID0gdGhpcy5nZXRDdXJyZW50UGFnZURhdGEoKTtcbiAgICB9XG5cbiAgICBnZXRDdXJyZW50UGFnZURhdGEoKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlICYmIHRoaXMucGFnZVNpemUgJiYgdGhpcy5iYWNrdXBEYXRhPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VTdGFydEluZGV4ID0gKHRoaXMuY3VycmVudFBhZ2UgKiB0aGlzLnBhZ2VTaXplKSAtIHRoaXMucGFnZVNpemU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iYWNrdXBEYXRhLnNsaWNlKHBhZ2VTdGFydEluZGV4LCBwYWdlU3RhcnRJbmRleCArIHRoaXMucGFnZVNpemUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBzZXRMb2FkaW5nKGxvYWRpbmc6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gbG9hZGluZztcbiAgICB9XG5cbiAgICBzZXROb0RhdGEobm9EYXRhOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMubm9EYXRhID0gbm9EYXRhO1xuICAgIH1cbn1cbiJdfQ==