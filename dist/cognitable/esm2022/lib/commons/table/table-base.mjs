import { EventEmitter } from '@angular/core';
export class TableBase {
    // Init
    afterTableInit = new EventEmitter();
    // Header
    tableHeaders;
    // Data
    tableData;
    // Backup
    backupData; // For backup the table data, so that additional processes won't be affecting it
    // Pagination
    paginationEnabled = false;
    allowedPageSizes = [10, 25, 50, 100];
    pageSize = 10;
    totalPages = 0;
    currentPage = 1;
    paginationButtons = [];
    // Table Action Events
    cellContentClicked = new EventEmitter();
    cellContentHover = new EventEmitter();
    // Table Size
    height = 400;
    // Overlays
    loading = false;
    noData = false;
    loadingMessage;
    noDataMessage;
    constructor() { }
    setBackupData(data) {
        this.backupData = JSON.parse(JSON.stringify(data ?? []));
    }
    sort(field, order) {
        if (!order) {
            this.tableData = JSON.parse(JSON.stringify(this.backupData ?? []));
        }
        else {
            this.tableData = this.tableData.sort((a, b) => {
                if (a[field] < b[field]) {
                    return order === 'asc' ? -1 : 1;
                }
                if (a[field] > b[field]) {
                    return order === 'asc' ? 1 : -1;
                }
                return 0;
            });
        }
    }
    filter(filterValue, headers) {
        // this.backupData = (filterValue && !this.backupData?.length) ? this.setBackupData(this.tableData) : this.backupData; // Taking the backup of original data
        if (headers?.length) {
            this.filterBySpecifiedFields(headers, filterValue);
        }
        else {
            this.filterByAllFields(filterValue);
        }
    }
    filterByAllFields(filterValue) {
        const nonSearchableHeaders = this.tableHeaders?.filter(header => header?.search?.columnSearchIgnored); // Filtering the search not allowed column headers
        const nonSearchFields = nonSearchableHeaders?.map(header => header.field);
        let temporaryData = JSON.parse(JSON.stringify(this.backupData ?? []));
        temporaryData = temporaryData.filter((record) => {
            for (const recordField in (record ?? {})) {
                if (!nonSearchFields?.includes(recordField)) {
                    const value = record[recordField];
                    if (typeof value === 'string' && value?.length && value.toLowerCase().includes(filterValue.toLowerCase())) {
                        return true;
                    }
                }
            }
            return false;
        });
        this.tableData = temporaryData;
    }
    filterBySpecifiedFields(filterValue, headers) {
    }
    loadPagination() {
        if (this.paginationEnabled && this.backupData?.length) {
            this.totalPages = Math.ceil(this.pageSize && this.backupData.length ? this.backupData.length / this.pageSize : 0);
            this.changePagination(1);
        }
    }
    changePagination(page) {
        this.currentPage = page;
        this.tableData = this.getCurrentPageData();
    }
    getCurrentPageData() {
        if (this.currentPage && this.pageSize && this.backupData?.length) {
            const pageStartIndex = (this.currentPage * this.pageSize) - this.pageSize;
            return this.backupData.slice(pageStartIndex, pageStartIndex + this.pageSize);
        }
        return [];
    }
    setLoading(loading) {
        this.loading = loading;
    }
    setNoData(noData) {
        this.noData = noData;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFibGUtYmFzZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tbW9ucy90YWJsZS90YWJsZS1iYXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFFM0MsTUFBTSxPQUFPLFNBQVM7SUFDbEIsT0FBTztJQUNBLGNBQWMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBRTNDLFNBQVM7SUFDRixZQUFZLENBQTRCO0lBRS9DLE9BQU87SUFDQSxTQUFTLENBQU07SUFFdEIsU0FBUztJQUNGLFVBQVUsQ0FBTSxDQUFDLGdGQUFnRjtJQUV4RyxhQUFhO0lBQ2IsaUJBQWlCLEdBQVksS0FBSyxDQUFDO0lBQ25DLGdCQUFnQixHQUFhLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDL0MsUUFBUSxHQUFXLEVBQUUsQ0FBQztJQUN0QixVQUFVLEdBQUcsQ0FBQyxDQUFDO0lBQ2YsV0FBVyxHQUFHLENBQUMsQ0FBQztJQUNoQixpQkFBaUIsR0FBVSxFQUFFLENBQUM7SUFFOUIsc0JBQXNCO0lBQ2Ysa0JBQWtCLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztJQUN4QyxnQkFBZ0IsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBRTdDLGFBQWE7SUFDYixNQUFNLEdBQVcsR0FBRyxDQUFDO0lBRXJCLFdBQVc7SUFDWCxPQUFPLEdBQVksS0FBSyxDQUFDO0lBQ3pCLE1BQU0sR0FBWSxLQUFLLENBQUM7SUFDeEIsY0FBYyxDQUFVO0lBQ3hCLGFBQWEsQ0FBVTtJQUV2QixnQkFBZ0IsQ0FBQztJQUVqQixhQUFhLENBQUMsSUFBUztRQUNuQixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLENBQUMs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ZWxzL3RhYmxlLWhlYWRlcic7XG5pbXBvcnQge0V2ZW50RW1pdHRlcn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmV4cG9ydCBjbGFzcyBUYWJsZUJhc2Uge1xuICAgIC8vIEluaXRcbiAgICBwdWJsaWMgYWZ0ZXJUYWJsZUluaXQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICAvLyBIZWFkZXJcbiAgICBwdWJsaWMgdGFibGVIZWFkZXJzOiBUYWJsZUhlYWRlcltdIHwgdW5kZWZpbmVkO1xuXG4gICAgLy8gRGF0YVxuICAgIHB1YmxpYyB0YWJsZURhdGE6IGFueTtcblxuICAgIC8vIEJhY2t1cFxuICAgIHB1YmxpYyBiYWNrdXBEYXRhOiBhbnk7IC8vIEZvciBiYWNrdXAgdGhlIHRhYmxlIGRhdGEsIHNvIHRoYXQgYWRkaXRpb25hbCBwcm9jZXNzZXMgd29uJ3QgYmUgYWZmZWN0aW5nIGl0XG5cbiAgICAvLyBQYWdpbmF0aW9uXG4gICAgcGFnaW5hdGlvbkVuYWJsZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBhbGxvd2VkUGFnZVNpemVzOiBudW1iZXJbXSA9IFsxMCwgMjUsIDUwLCAxMDBdO1xuICAgIHBhZ2VTaXplOiBudW1iZXIgPSAxMDtcbiAgICB0b3RhbFBhZ2VzID0gMDtcbiAgICBjdXJyZW50UGFnZSA9IDE7XG4gICAgcGFnaW5hdGlvbkJ1dHRvbnM6IGFueVtdID0gW107XG5cbiAgICAvLyBUYWJsZSBBY3Rpb24gRXZlbnRzXG4gICAgcHVibGljIGNlbGxDb250ZW50Q2xpY2tlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBwdWJsaWMgY2VsbENvbnRlbnRIb3ZlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgIC8vIFRhYmxlIFNpemVcbiAgICBoZWlnaHQ6IG51bWJlciA9IDQwMDtcblxuICAgIC8vIE92ZXJsYXlzXG4gICAgbG9hZGluZzogYm9vbGVhbiA9IGZhbHNlO1xuICAgIG5vRGF0YTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGxvYWRpbmdNZXNzYWdlITogc3RyaW5nO1xuICAgIG5vRGF0YU1lc3NhZ2UhOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHsgfVxuXG4gICAgc2V0QmFja3VwRGF0YShkYXRhOiBhbnkpIHtcbiAgICAgICAgdGhpcy5iYWNrdXBEYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhID8/IFtdKSlcbiAgICB9XG5cbiAgICBzb3J0KGZpZWxkOiBzdHJpbmcsIG9yZGVyOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKCFvcmRlcikge1xuICAgICAgICAgICAgdGhpcy50YWJsZURhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuYmFja3VwRGF0YSA/PyBbXSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50YWJsZURhdGEgPSB0aGlzLnRhYmxlRGF0YS5zb3J0KChhOiBhbnksIGI6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChhW2ZpZWxkXSA8IGJbZmllbGRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmRlciA9PT0gJ2FzYycgPyAtMSA6IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhW2ZpZWxkXSA+IGJbZmllbGRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmRlciA9PT0gJ2FzYycgPyAxIDogLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmaWx0ZXIoZmlsdGVyVmFsdWU6IGFueSwgaGVhZGVycz86IFRhYmxlSGVhZGVyW10pIHtcbiAgICAgICAgLy8gdGhpcy5iYWNrdXBEYXRhID0gKGZpbHRlclZhbHVlICYmICF0aGlzLmJhY2t1cERhdGE/Lmxlbmd0aCkgPyB0aGlzLnNldEJhY2t1cERhdGEodGhpcy50YWJsZURhdGEpIDogdGhpcy5iYWNrdXBEYXRhOyAvLyBUYWtpbmcgdGhlIGJhY2t1cCBvZiBvcmlnaW5hbCBkYXRhXG4gICAgICAgIGlmIChoZWFkZXJzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyQnlTcGVjaWZpZWRGaWVsZHMoaGVhZGVycywgZmlsdGVyVmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJCeUFsbEZpZWxkcyhmaWx0ZXJWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmaWx0ZXJCeUFsbEZpZWxkcyhmaWx0ZXJWYWx1ZTogYW55KSB7XG4gICAgICAgIGNvbnN0IG5vblNlYXJjaGFibGVIZWFkZXJzID0gdGhpcy50YWJsZUhlYWRlcnM/LmZpbHRlcihoZWFkZXIgPT4gaGVhZGVyPy5zZWFyY2g/LmNvbHVtblNlYXJjaElnbm9yZWQpOyAvLyBGaWx0ZXJpbmcgdGhlIHNlYXJjaCBub3QgYWxsb3dlZCBjb2x1bW4gaGVhZGVyc1xuICAgICAgICBjb25zdCBub25TZWFyY2hGaWVsZHMgPSBub25TZWFyY2hhYmxlSGVhZGVycz8ubWFwKGhlYWRlciA9PiBoZWFkZXIuZmllbGQpO1xuICAgICAgICBsZXQgdGVtcG9yYXJ5RGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5iYWNrdXBEYXRhID8/IFtdKSk7XG4gICAgICAgIHRlbXBvcmFyeURhdGEgPSB0ZW1wb3JhcnlEYXRhLmZpbHRlcihcbiAgICAgICAgICAgIChyZWNvcmQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcmVjb3JkRmllbGQgaW4gKHJlY29yZCA/PyB7fSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFub25TZWFyY2hGaWVsZHM/LmluY2x1ZGVzKHJlY29yZEZpZWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSByZWNvcmRbcmVjb3JkRmllbGRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWU/Lmxlbmd0aCAmJiB2YWx1ZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclZhbHVlLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IHRlbXBvcmFyeURhdGE7XG4gICAgfVxuXG4gICAgZmlsdGVyQnlTcGVjaWZpZWRGaWVsZHMoZmlsdGVyVmFsdWU6IGFueSwgaGVhZGVycz86IFRhYmxlSGVhZGVyW10pIHtcblxuICAgIH1cblxuICAgIGxvYWRQYWdpbmF0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5wYWdpbmF0aW9uRW5hYmxlZCAmJiB0aGlzLmJhY2t1cERhdGE/Lmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy50b3RhbFBhZ2VzID0gTWF0aC5jZWlsKHRoaXMucGFnZVNpemUgJiYgdGhpcy5iYWNrdXBEYXRhLmxlbmd0aCA/IHRoaXMuYmFja3VwRGF0YS5sZW5ndGggLyB0aGlzLnBhZ2VTaXplIDogMCk7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZVBhZ2luYXRpb24oMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjaGFuZ2VQYWdpbmF0aW9uKHBhZ2U6IGFueSkge1xuICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gcGFnZTtcbiAgICAgICAgdGhpcy50YWJsZURhdGEgPSB0aGlzLmdldEN1cnJlbnRQYWdlRGF0YSgpO1xuICAgIH1cblxuICAgIGdldEN1cnJlbnRQYWdlRGF0YSgpIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgJiYgdGhpcy5wYWdlU2l6ZSAmJiB0aGlzLmJhY2t1cERhdGE/Lmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgcGFnZVN0YXJ0SW5kZXggPSAodGhpcy5jdXJyZW50UGFnZSAqIHRoaXMucGFnZVNpemUpIC0gdGhpcy5wYWdlU2l6ZTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJhY2t1cERhdGEuc2xpY2UocGFnZVN0YXJ0SW5kZXgsIHBhZ2VTdGFydEluZGV4ICsgdGhpcy5wYWdlU2l6ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIHNldExvYWRpbmcobG9hZGluZzogYm9vbGVhbikge1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBsb2FkaW5nO1xuICAgIH1cblxuICAgIHNldE5vRGF0YShub0RhdGE6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5ub0RhdGEgPSBub0RhdGE7XG4gICAgfVxufVxuIl19